[gd_scene load_steps=18 format=3 uid="uid://dr675s8d58dhy"]

[ext_resource type="Script" path="res://scripts/misc/RageCage.gd" id="1_kx8wp"]
[ext_resource type="PackedScene" uid="uid://cd0f3kaj2vli3" path="res://scenes/objects/wall.tscn" id="2_vkcpo"]
[ext_resource type="PackedScene" uid="uid://crc10cctsupco" path="res://scenes/objects/ball.tscn" id="3_nw3fr"]
[ext_resource type="Shader" path="res://shaders/TrailCG.gdshader" id="4_0pnm1"]
[ext_resource type="Shader" path="res://shaders/TheBall.gdshader" id="4_fo58x"]
[ext_resource type="PackedScene" uid="uid://brbfliohi7w1j" path="res://scenes/objects/trail.tscn" id="4_fwfqd"]
[ext_resource type="Script" path="res://scripts/global/Background.gd" id="4_ixmyk"]
[ext_resource type="PackedScene" uid="uid://cerylx43rxt76" path="res://scenes/objects/background_ball.tscn" id="5_lllu1"]
[ext_resource type="Script" path="res://scripts/playfield/TheBall.gd" id="5_rft8u"]
[ext_resource type="Script" path="res://scripts/global/VariableTimer.gd" id="6_2yiqg"]
[ext_resource type="PackedScene" uid="uid://bngtx6rr0whah" path="res://scenes/objects/bumper.tscn" id="6_86i7m"]
[ext_resource type="PackedScene" uid="uid://dtoyv1n8ll5pk" path="res://scenes/objects/inward_pulse.tscn" id="6_g3fsg"]
[ext_resource type="Shader" path="res://shaders/PlayfieldGrid.gdshader" id="7_40tqo"]
[ext_resource type="Script" path="res://scripts/playfield/Foreground.gd" id="7_uwvxh"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ncies"]
resource_local_to_scene = true
shader = ExtResource("4_fo58x")
shader_parameter/brightness = 0.5

[sub_resource type="ShaderMaterial" id="ShaderMaterial_pfnx4"]
shader = ExtResource("7_40tqo")
shader_parameter/distortionIntensity = 0.15
shader_parameter/distortionVariation = 0.2
shader_parameter/gridLineFrequency = 100.0
shader_parameter/gridLineWidth = 10.0
shader_parameter/gridLineXOffset = 45.0
shader_parameter/gridLineYOffset = 45.0
shader_parameter/gridSaturation = 0.5
shader_parameter/centerOffset = Vector2(0, 0)
shader_parameter/visibilityCutoff = 1.0

[sub_resource type="ShaderMaterial" id="ShaderMaterial_hkwyc"]
shader = ExtResource("4_0pnm1")

[node name="RageCage" type="Control" node_paths=PackedStringArray("camera", "background", "theBall", "ballsControl", "trailsCG")]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(480, 270)
script = ExtResource("1_kx8wp")
camera = NodePath("Camera2D")
background = NodePath("Background")
theBall = NodePath("MainViewport/Foreground/TheBall")
ballPrefab = ExtResource("3_nw3fr")
ballsControl = NodePath("MainViewport/TheBallZone")
trailPrefab = ExtResource("4_fwfqd")
trailsCG = NodePath("MainViewport/Trails")

[node name="Camera2D" type="Camera2D" parent="."]
anchor_mode = 0

[node name="Background" type="ColorRect" parent="." node_paths=PackedStringArray("backgroundBallsControl")]
layout_mode = 1
anchors_preset = -1
anchor_left = -0.052
anchor_top = -0.481
anchor_right = 1.052
anchor_bottom = 1.481
offset_left = -0.079998
offset_top = -0.259979
offset_right = 0.0799561
offset_bottom = 0.259949
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)
script = ExtResource("4_ixmyk")
backgroundBallPrefab = ExtResource("5_lllu1")
backgroundBallsControl = NodePath("BackgroundBalls")

[node name="BackgroundBalls" type="Control" parent="Background"]
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="SpawnBackgroundBall" type="Timer" parent="Background"]
autostart = true
script = ExtResource("6_2yiqg")
baseTime = 0.15
timeDeviation = 0.05

[node name="ChangeFlow" type="Timer" parent="Background"]
autostart = true
script = ExtResource("6_2yiqg")
baseTime = 15.0
timeDeviation = 5.0

[node name="MainViewport" type="Control" parent="."]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -480.0
offset_top = -270.0
offset_right = 480.0
offset_bottom = 270.0
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(480, 270)

[node name="Foreground" type="Polygon2D" parent="MainViewport" node_paths=PackedStringArray("grid", "theBall")]
clip_children = 1
polygon = PackedVector2Array(0, 0, 315, 0, 480, 98, 647, 0, 960, 0, 960, 540, 648, 540, 480, 440, 312, 540, 0, 540)
script = ExtResource("7_uwvxh")
grid = NodePath("Grid")
theBall = NodePath("TheBall")

[node name="Background" type="ColorRect" parent="MainViewport/Foreground"]
offset_right = 960.0
offset_bottom = 540.0
color = Color(0, 0, 0, 1)

[node name="InwardPulses" type="Control" parent="MainViewport/Foreground"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 960.0
offset_bottom = 540.0
grow_horizontal = 2
grow_vertical = 2

[node name="TheBall" type="ColorRect" parent="MainViewport/Foreground" node_paths=PackedStringArray("inwardPulsesControl")]
material = SubResource("ShaderMaterial_ncies")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 426.0
offset_top = 216.0
offset_right = 534.0
offset_bottom = 324.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("5_rft8u")
inwardPulsesControl = NodePath("../InwardPulses")
inwardPulsePrefab = ExtResource("6_g3fsg")

[node name="Grid" type="ColorRect" parent="MainViewport/Foreground"]
material = SubResource("ShaderMaterial_pfnx4")
offset_right = 960.0
offset_bottom = 540.0
color = Color(0, 0, 0, 1)

[node name="Trails" type="CanvasGroup" parent="MainViewport"]
material = SubResource("ShaderMaterial_hkwyc")

[node name="TheBallZone" type="Control" parent="MainViewport"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="Features" type="Control" parent="MainViewport"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="Walls" type="Control" parent="MainViewport/Features"]
anchors_preset = 0

[node name="TopLeftWall" parent="MainViewport/Features/Walls" instance=ExtResource("2_vkcpo")]
offset_top = -10.0
offset_right = 305.0
staticWall = true
sideLength = 305.0
flipped = true

[node name="TopRightWall" parent="MainViewport/Features/Walls" instance=ExtResource("2_vkcpo")]
offset_left = 655.0
offset_top = -10.0
offset_right = 960.0
staticWall = true
sideLength = 305.0
flipped = true

[node name="RightWall" parent="MainViewport/Features/Walls" instance=ExtResource("2_vkcpo")]
offset_left = 970.0
offset_right = 1510.0
rotation = 1.5708
staticWall = true
flipped = true

[node name="BottomLeftWall" parent="MainViewport/Features/Walls" instance=ExtResource("2_vkcpo")]
offset_left = 305.0
offset_top = 550.0
offset_right = 610.0
offset_bottom = 550.0
rotation = 3.14159
staticWall = true
sideLength = 305.0
flipped = true

[node name="BottomRightWall" parent="MainViewport/Features/Walls" instance=ExtResource("2_vkcpo")]
offset_left = 960.0
offset_top = 550.0
offset_right = 1265.0
offset_bottom = 550.0
rotation = 3.14159
staticWall = true
sideLength = 305.0
flipped = true

[node name="LeftWall" parent="MainViewport/Features/Walls" instance=ExtResource("2_vkcpo")]
offset_left = -10.0
offset_top = 540.0
offset_right = 530.0
offset_bottom = 540.0
rotation = 4.71239
staticWall = true
flipped = true

[node name="Upper Left Wedge" parent="MainViewport/Features/Walls" instance=ExtResource("2_vkcpo")]
offset_left = 310.0
offset_top = -9.0
offset_right = 510.0
offset_bottom = -9.0
rotation = 0.523599
staticWall = true
sideLength = 200.0
flipped = true

[node name="Upper Right Wedge" parent="MainViewport/Features/Walls" instance=ExtResource("2_vkcpo")]
offset_left = 477.0
offset_top = 91.0
offset_right = 677.0
offset_bottom = 91.0
rotation = -0.523599
staticWall = true
sideLength = 200.0
flipped = true

[node name="Lower Left Wedge" parent="MainViewport/Features/Walls" instance=ExtResource("2_vkcpo")]
offset_left = 483.0
offset_top = 449.0
offset_right = 683.0
offset_bottom = 449.0
rotation = 2.61799
staticWall = true
sideLength = 200.0
flipped = true

[node name="Lower Right Wedge" parent="MainViewport/Features/Walls" instance=ExtResource("2_vkcpo")]
offset_left = 650.0
offset_top = 549.0
offset_right = 850.0
offset_bottom = 549.0
rotation = -2.61799
staticWall = true
sideLength = 200.0
flipped = true

[node name="Bumpers" type="Control" parent="MainViewport/Features"]
anchors_preset = 0

[node name="Top Left Bumper" parent="MainViewport/Features/Bumpers" instance=ExtResource("6_86i7m")]

[node name="Top Right Bumper" parent="MainViewport/Features/Bumpers" instance=ExtResource("6_86i7m")]
offset_left = 960.0
offset_right = 960.0

[node name="Bottom Left Bumper" parent="MainViewport/Features/Bumpers" instance=ExtResource("6_86i7m")]
offset_top = 540.0
offset_bottom = 540.0

[node name="Bottom Right Bumper" parent="MainViewport/Features/Bumpers" instance=ExtResource("6_86i7m")]
offset_left = 960.0
offset_top = 540.0
offset_right = 960.0
offset_bottom = 540.0

[node name="Upper Wedge Bumper" parent="MainViewport/Features/Bumpers" instance=ExtResource("6_86i7m")]
offset_left = 480.0
offset_top = 98.0
offset_right = 480.0
offset_bottom = 98.0

[node name="Bottom Wedge Bumper" parent="MainViewport/Features/Bumpers" instance=ExtResource("6_86i7m")]
offset_left = 480.0
offset_top = 440.0
offset_right = 480.0
offset_bottom = 440.0

[node name="Left Central Bumper" parent="MainViewport/Features/Bumpers" instance=ExtResource("6_86i7m")]
offset_left = 240.0
offset_top = 270.0
offset_right = 240.0
offset_bottom = 270.0
radius = 20.0

[node name="Right Central Bumper" parent="MainViewport/Features/Bumpers" instance=ExtResource("6_86i7m")]
offset_left = 720.0
offset_top = 270.0
offset_right = 720.0
offset_bottom = 270.0
radius = 20.0

[connection signal="timeout" from="Background/SpawnBackgroundBall" to="Background" method="addBackgroundBall"]
[connection signal="timeout" from="Background/ChangeFlow" to="Background" method="initiateFlowChange"]
